set.seed(45)

n=10000
x=numeric(n)
phi=0.6

for (i in 2:n){
 x[i]=rnorm(1,phi*x[i-1],1.0)
}
plot.ts(x)
hist(x,freq=FALSE)
curve(dnorm(x,0,sqrt(1/(1-phi^2))),col="red",add=TRUE)
# --------------------------------------
Q=matrix(c( 0.0,0.5,0.5,
	    	0.5,0.0,0.5,
		0.5,0.5,0.0),
		nrow=3,byrow=TRUE)
QQ=Q
m=30
for(i in 2:m){
	QQ=QQ %*% Q
}
QQ

Q %*% Q
# --------------------------------------
Q=matrix(c( 0.0,0.5,0.0,0.5,
	    	0.5,0.0,0.5,0.0,
		0.0,0.5,0.0,0.5,
	    	0.5,0.0,0.5,0.0),
		nrow=4,byrow=TRUE)
QQ=Q
m=3000
for(i in 2:m){
	QQ=QQ %*% Q
}
QQ

Q %*% Q

# ---------------------------------------
Q=matrix(c(0.0,0.5,0.0,0.0,0.5,
	     0.5,0.0,0.5,0.0,0.0,
	     0.0,0.5,0.0,0.5,0.0,
	     0.0,0.0,0.5,0.0,0.5,
	     0.5,0.0,0.0,0.5,0.0),
		nrow=5,byrow=TRUE)
QQ=Q
m=500
for(i in 2:m){
	QQ=QQ %*% Q
}
QQ
# ---------------------------------------
Q=matrix(c(0.0,0.5,0.0,0.0,0.0,0.5,
	     0.5,0.0,0.5,0.0,0.0,0.0,
	     0.0,0.5,0.0,0.5,0.0,0.0,
	     0.0,0.0,0.5,0.0,0.5,0.0,
	     0.0,0.0,0.0,0.5,0.0,0.5,
	     0.5,0.0,0.0,0.0,0.5,0.0),
		nrow=6,byrow=TRUE)
QQ=Q
m=3000
for(i in 2:m){
	QQ=QQ %*% Q
}
QQ
#----------------------------
Q=matrix(c(0,1,0.3,0.7),nrow=2,byrow=TRUE)
#----------------------------
Q=matrix(c(1,0,0.3,0.7),nrow=2,byrow=TRUE)

	